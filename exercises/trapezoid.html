<!--
Google IO 2012/2013 HTML5 Slide Template

Authors: Eric Bidelman <ebidel@gmail.com>
         Luke Mah√© <lukem@google.com>

URL: https://code.google.com/p/io-2012-slides
--><!DOCTYPE html>


<html>
<head>
  <title>Trapezoidal Rule &mdash; Intro to Python</title>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">

  <meta name="hieroglyph-title" data-config-title>
  <meta name="hieroglyph-subtitle" data-config-subtitle>
  <meta name="hieroglyph-presenter" data-config-presenter>

  
  <link rel="stylesheet" media="all"
        href="../_static/theme/css/default.css">
  <link rel="stylesheet" media="all"
        href="../_static/theme/css/hieroglyph.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)"
        href="../_static/theme/css/phone.css">

    
    <link rel="stylesheet" href="../_static/custom.css"
          type="text/css" />
    

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script data-main="../_static/js/slides"
            src="../_static/js/require-1.0.8.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="top" title="Intro to Python" href="../index.html" />
    <link rel="up" title="Exercises" href="index.html" />
    <link rel="next" title="HTML Renderer Exercise" href="html_renderer.html" />
    <link rel="prev" title="lambda and keyword Magic" href="lambda_magic.html" /> 
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
<!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
<hgroup class="auto-fadein">
  <h1 data-config-title><!-- populated from slide_config.json --></h1>
  <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
  <p data-config-presenter><!-- populated from slide_config.json --></p>
</hgroup>
</slide>

  
    <slide class="title-slide segue nobackground level-1" id="trapezoidal-rule">
    <hgroup>
      <h1>Trapezoidal Rule</h1>
    </hgroup>
    <article class="">
      



    </article>
  </slide>  <slide class="level-2" id="passing-functions-around">
    <hgroup>
      <h2>Passing functions around</h2>
    </hgroup>
    <article class="">
      <p class="large left">Goal:</p>
<p class="medium left">Making use of functions as objects -- functions that act on functions.</p>




    </article>
  </slide>  <slide class="level-3" id="id1">
    <hgroup>
      <h3>Trapezoidal rule</h3>
    </hgroup>
    <article class="">
      <p class="medium">The &quot;trapezoidal rule&quot;:</p>
<p class="medium"><a class="reference external" href="https://en.wikipedia.org/wiki/Trapezoidal_rule">https://en.wikipedia.org/wiki/Trapezoidal_rule</a></p>
<p class="medium">Is one of the easiest &quot;quadrature&quot; methods.</p>
<p class="medium">Otherwise known as computing a definite integral, or, simply,</p>
<p class="medium">Computing the area under a curve.</p>




    </article>
  </slide>  <slide class="level-3" id="the-task">
    <hgroup>
      <h3>The task</h3>
    </hgroup>
    <article class="">
      <p>Your task is to write a <code class="docutils literal"><span class="pre">trapz()</span></code> function that will compute the area under an arbitrary function, using the trapezoidal rule.</p>
<p>The function will take another function as an argument, as well as the start and end points to compute, and return the area under the curve.</p>




    </article>
  </slide>  <slide class="level-3" id="example">
    <hgroup>
      <h3>Example:</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;a very simple straight horizontal line at y = 5&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="mi">5</span>

<span class="n">area</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">area</span>
<span class="mi">50</span>
</pre></div>
</div>
<p>About the simplest &quot;curve&quot; you can have is a horizontal straight line, in this case, at y = 5. The area under that line from 0 to 10 is a rectangle that is 10 wide and 5 high, so with an area of 50.</p>
<p>Of course in this case, it's easiest to simply multiply the height times the width, but we want a function that will work for <strong>Any</strong> curve.</p>
<p>HINT: this simple example could be a good test case!</p>




    </article>
  </slide>  <slide class="level-3" id="the-solution">
    <hgroup>
      <h3>The Solution:</h3>
    </hgroup>
    <article class="">
      <p>Your function definition should look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">trapz</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the area under the curve defined by</span>
<span class="sd">    y = fun(x), for x between a and b</span>

<span class="sd">    :param fun: the function to evaluate</span>
<span class="sd">    :type fun: a function that takes a single parameter</span>

<span class="sd">    :param a: the start point for teh integration</span>
<span class="sd">    :type a: a numeric value</span>

<span class="sd">    :param b: the end point for the integration</span>
<span class="sd">    :type b: a numeric value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>




    </article>
  </slide>  <slide class="level-3" id="id2">
    <hgroup>
      <h3>The Solution:</h3>
    </hgroup>
    <article class="">
      <p>In the function, you want to compute the following equation:</p>
<div class="math">
\[area = \frac{b-a}{2N}(f(x_0) + 2f(x_1) + 2f(x_2) + \dotsb + 2f(x_{N-1}) + f(x_N))\]</div>
<p>So you will need to:</p>
<blockquote>
<div><ul class="simple">
<li>create a list of x values from a to b (maybe 100 or so values to start)</li>
<li>compute the function for each of those values and double them</li>
<li>add them all up</li>
<li>multiply by the half of the difference between a and b divided by the number of steps.</li>
</ul>
</div></blockquote>




    </article>
  </slide>  <slide class="level-3" id="id3">
    <hgroup>
      <h3>The Solution:</h3>
    </hgroup>
    <article class="">
      <p>Note that the first and last values are not doubled, so it may be more efficient to rearrange it like this:</p>
<div class="math">
\[area = \frac{b-a}{N} \left( \frac{f(x_0) + f(x_{N})}{2} + \sum_{i=1}^{N-1} f(x_i) \right)\]</div>
<p>Can you use comprehensions for this?</p>
<p>NOTE: <code class="docutils literal"><span class="pre">range()</span></code> only works for integers -- how can you deal with that?</p>




    </article>
  </slide>  <slide class="level-3" id="id4">
    <hgroup>
      <h3>The Solution:</h3>
    </hgroup>
    <article class="">
      <p>Once you have that, it should work for any function that can be evaluated between a and b.</p>
<p>Try it for some built-in math functions, like <code class="docutils literal"><span class="pre">math.sin</span></code></p>




    </article>
  </slide>  <slide class="level-3" id="tests">
    <hgroup>
      <h3>tests</h3>
    </hgroup>
    <article class="">
      <p>Do this using test-drive development.</p>
<p>A few examples of analytical solutions you can use for tests:</p>
<p>A simple horizontal line -- see above.</p>




    </article>
  </slide>  <slide class="level-3" id="id5">
    <hgroup>
      <h3>tests</h3>
    </hgroup>
    <article class="">
      <p>A sloped straight line:</p>
<div class="math">
\[\int_a^b  y = mx + B = \frac{1}{2} m (b^2-a^2) + B (b-a)\]</div>
<p>The quadratic:</p>
<div class="math">
\[\int_a^b  y = Ax^2 + Bx + C = \frac{A}{3} (b^3-a^3) + \frac{B}{2} (b^2-a^2) + C (b-a)\]</div>
<p>The sine function:</p>
<div class="math">
\[\int_a^b \sin(x) = \cos(a) - \cos(b)\]</div>




    </article>
  </slide>  <slide class="level-3" id="computational-accuracy">
    <hgroup>
      <h3>Computational Accuracy</h3>
    </hgroup>
    <article class="">
      <p>In the case of the linear functions, the result should theoretically be exact. But with the vagaries of floating point math may not be.</p>
<p>And for non-linear functions, the result will certainly not be exact.</p>
<p>So you want to check if the answer is <em>close</em> to what you expect.</p>
<p>In py3.5 -- there is an <code class="docutils literal"><span class="pre">isclose()</span></code> function (PEP485)</p>
<p><a class="reference external" href="https://www.python.org/dev/peps/pep-0485/">https://www.python.org/dev/peps/pep-0485/</a></p>
<p>In earlier pythons -- you'll need your own. There is one in:</p>
<p><code class="docutils literal"><span class="pre">Examples/Session06/test_trapz.py</span></code></p>




    </article>
  </slide>  <slide class="level-3" id="stage-two">
    <hgroup>
      <h3>Stage two:</h3>
    </hgroup>
    <article class="">
      <p>Some functions need extra parameters to do their thing. But the above will only handle a single parameter. For example, a quadratic function:</p>
<div class="math">
\[y = A x^2 + Bx + C\]</div>
<p>Requires values for A, B, and C in order to compute y from an given x.</p>
<p>You could write a specialized version of this function for each A, B, and C:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">quad1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span>
</pre></div>
</div>
<p>But then you need to write a new function for any value of these parameters you might need.</p>




    </article>
  </slide>  <slide class="level-3" id="id6">
    <hgroup>
      <h3>Stage two:</h3>
    </hgroup>
    <article class="">
      <p>Instead, you can pass in A, B and C each time:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">quadratic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">C</span>
</pre></div>
</div>
<p>Nice and general purpose.</p>
<p>But how would we compute the area under this function?</p>
<p>The function we wrote above only passes x in to the function it is integrating.</p>




    </article>
  </slide>  <slide class="level-3" id="passing-arguments-through">
    <hgroup>
      <h3>Passing arguments through:</h3>
    </hgroup>
    <article class="">
      <p>Update your trapz() function so that you can give it a function that takes arbitrary extra arguments, either positional or keyword, after the x.</p>
<p>So you can do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trapz</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trapz</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">coef</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;A&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">trapz</span><span class="p">(</span><span class="n">quadratic</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">coef</span><span class="p">)</span>
</pre></div>
</div>




    </article>
  </slide>  <slide class="level-3" id="id7">
    <hgroup>
      <h3>Passing arguments through:</h3>
    </hgroup>
    <article class="">
      <p><strong>NOTE:</strong> Make sure this will work with ANY function, with <strong>ANY</strong> additional positional or keyword arguments -- not just this particular function.</p>
<p>This is pretty conceptually challenging -- but it's very little code!</p>
<p>If you are totally lost -- look at the lecture notes from last class -- how can you both accept and pass arbitrary arguments to/from a function?</p>




    </article>
  </slide>  <slide class="level-3" id="id8">
    <hgroup>
      <h3>Passing arguments through:</h3>
    </hgroup>
    <article class="">
      <p>You want your trapz function to take ANY function that can take ANY arbitrary extra arguments -- not just the quadratic function, and not just <code class="docutils literal"><span class="pre">A,B,</span> <span class="pre">and</span> <span class="pre">C</span></code>. So good to test with another example.</p>
<p>The generalized sine function is:</p>
<div class="math">
\[A \sin(\omega t)\]</div>
<p>where <span class="math">\(A\)</span> is the amplitude, and <span class="math">\(\omega\)</span> is the frequency of the function. In this case, the area under the curve from a to b is:</p>
<div class="math">
\[\frac{A}{\omega} \left( \cos(\omega a) - \cos(\omega b) \right)\]</div>
<p>The test code has a test for this one, too.</p>




    </article>
  </slide>  <slide class="level-3" id="currying">
    <hgroup>
      <h3>Currying</h3>
    </hgroup>
    <article class="">
      <p>Another way to solve the above problem is to use the original <code class="docutils literal"><span class="pre">trapz</span></code>, and create a custom version of the quadratic() function instead.</p>
<p>Write a function that takes <code class="docutils literal"><span class="pre">A,</span> <span class="pre">B,</span> <span class="pre">and</span> <span class="pre">C</span></code> as arguments, and returns a function that evaluates the quadratic for those particular coefficients.</p>
<p>Try passing the results of this into your <code class="docutils literal"><span class="pre">trapz()</span></code> and see if you get the same answer.</p>




    </article>
  </slide>  <slide class="level-3" id="partial">
    <hgroup>
      <h3>partial</h3>
    </hgroup>
    <article class="">
      <p>Do the above with <code class="docutils literal"><span class="pre">functools.partial</span></code> as well.</p>




    </article>
  </slide>  <slide class="level-3" id="extra-credit">
    <hgroup>
      <h3>Extra credit</h3>
    </hgroup>
    <article class="">
      <p>This isn't really the point of the exercise, but see if you can make it dynamically accurate.</p>
<p>How accurate it is depends on how small the chunks are that you break the function up into.</p>
<p>See if you can think of a way to dynamically determine how small a step you should use.</p>
<p>This is one for the math and computational programming geeks!</p>




    </article>
  </slide>


  <slide class="thank-you-slide segue nobackground">
  <article class="flexbox vleft auto-fadein">
    <h2>Thank You!</h2>
  </article>
  <p class="auto-fadein" data-config-contact>
    <!-- populated from slide_config.json -->
  </p>
</slide>

  <slide class="backdrop"></slide>

</slides>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>